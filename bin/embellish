#!/usr/bin/env python
from embellish import engine
import sys
import os
import shutil
import codecs
import datetime
from hashlib import md5
import re
import copy
import pprint

import yaml

from jinja2 import Environment, FileSystemLoader
from jinja2_hamlpy import HamlPyExtension

from markdown import markdown


usage = '''
==================================================
Embellish: a low friction static website generator
==================================================
Looks for markdown files (*markdown, *mkd, *md, *txt) and
converts them into HTML pages. 

Metadata in the markdown files can invoke HAML/jinja2
templates (*haml), or jinja2 templates(any other extension).

usage: embellish.py web_dir|site.yaml 
'''

if len(sys.argv) == 1:
  print(usage)
else:
  if os.path.isfile(sys.argv[1]):
    site = engine.read_config_yaml(sys.argv[1])
  else:
    os.chdir(sys.argv[1])
    site = engine.default_site
  engine.generate_site_incrementally(site)

  
