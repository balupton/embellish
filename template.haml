!!! 5
%head
  %meta{content:'initial-scale=1.0',name:'viewport'}
  %link{href:'articulator.css',rel:'stylesheet'}
  :css
    body, html { 
      margin: 0;
      height: 100%;
      width: 100%; 
      overflow: hidden;
    }
    body {
      background-image: url(grey_wash_wall.png);
      background-repeat: repeat;
      font-family: 'Helvetica Neue', sans-serif;
      letter-spacing: 0.1em;
      font-size: 14px;
      color: #333;
      line-height: 1.5em; }
    .main {
      height: 100%;
      width: 100%;
    }
    .sidebar {
      position: absolute;
      top: 0;
      background-color: #99F;
      width: 180px;
      text-align: left;
      padding-top: 140px;
      overflow: auto;
      height: 100%;
    }
    .figures {
      position: absolute;
      top: 0;
      width: 460px;
      height: 100%;
      overflow: auto;
      background-color: #EEF;
    }
    .text {
      position: absolute;
      top: 0;
      background-color: white;
      float: left;
      width: 430px;
      padding: 0px 40px;
      height: 100%;
      overflow: auto;
    }
    h1, h2, h3, h4 {
      font-family: "Helvetica Neue", sans-serif;
      color: #333;
      letter-spacing: 0.1em;
      font-weight: 500;
      line-height: 1em; 
      padding-top: 2em;
      padding-bottom: 0 }
    h1 {
      font-size: 45px; 
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding-top: 100px;
      padding-bottom: 0em }
    h2 {
      font-size: 23px;
      letter-spacing: 0.1em;
      padding-top: 2em;
      padding-bottom: 0em; }
    h3 {
      font-size: 14px;
      font-weight: 900;
      text-transform: uppercase;
    }
    .timestamp {
      margin-top: 6em;
      text-align: right;
      color: #999;
      border-top: 1px solid #CCC;
      font-size: 10px }
    .timestamp, 
    .timestamp a:link, 
    .timestamp a:visited {
      color: #888; }
    .timestamp a {
      text-decoration: underline; }
    blockquote {
      border-left: 5px solid #DDD;
      margin-left: 0;
      padding-left: 2em;
      color: #888; }
    code {
      padding: 0px 2px; }
    pre {
      margin: 0; }
    .codehilite {
      overflow: auto;
      padding: 7px 20px; }
    pre {
      border: none  }
    .codehilite, code  {
      background-color: #F9F9FF;
      border: 2px solid #EEF; }
    .codehilite code {
      border: none }
    code, .codehilite {
      color: #777;
      font-size: 12px; 
      line-height: 1.5em; }

    @media screen and (max-width: 600px) {
      body {
        width: auto;
        margin: 0; 
        padding-left: 20px;
        padding-right: 20px} 
      .fig-in-text {
        display: block;
        background-color: #DDF;
        padding: 10px;
      }
    }

%body
  .main
    .sidebar.touchscroll
    .text.touchscroll
      .relative_position
        - if page.title:
          %h1 {{ page.title }}

        {{ page.content }}

        .timestamp
          generated by 
          %a{href:'http://github.com/boscoh/embellish'} embellish
          - if 'category' in page and page.category:
            in category: {{ page.category }},
          on {{ page.date.strftime("%d %b %Y") }}
    .figures.touchscroll

%script{type:'text/javascript', src:'jquery-2.0.3.js'}
%script{type:'text/javascript', src:'jquery.scrollTo.js'}
%script{type:'text/javascript', src:'articulator.js'}

:javascript
  var resize_window = function() {
    var window_width = $(window).width();
    var margin = 60;
    var two_column_width = 1200
    var one_columnn_width = 600
    if (window_width > two_column_width) {
      $('.sidebar').css('display','block');
      $('.figures').css('display','block');
      resize.set_outer_width($('.text'), 510);
      resize.set_left($('.sidebar'), margin);
      var left = resize.get_right($('.sidebar'));
      resize.set_left($('.text'), left);
      var figlist_width = 
          window_width - margin - margin
          - resize.get_outer_width($('.sidebar')) 
          - resize.get_outer_width($('.text'))
      var left = resize.get_right($('.text'));
      resize.set_left($('.figures'), left);
      resize.set_outer_width($('.figures'), figlist_width);
    } else if (window_width > one_columnn_width) {
      $('.sidebar').css('display','none');
      $('.figures').css('display','block');
      var half_window_width = Math.round(window_width/2);
      resize.set_left($('.text'), 0);
      resize.set_outer_width($('.text'), half_window_width);
      var figlist_width = window_width - half_window_width;
      resize.set_left($('.figures'), half_window_width);
      resize.set_outer_width($('.figures'), figlist_width);
    } else {
      $('.sidebar').css('display','none');
      $('.figures').css('display','none');
      resize.set_left($('.text'), 0);
      resize.set_outer_width($('.text'), window_width);
    }
  };

  var init = function() {
    touchscroll.init();
    articulator.set_figures_and_toc(
        '.sidebar', '.text', '.figures');
    $(window).resize(resize_window);
    resize_window(true);
  };

  $(window).ready(init);
  